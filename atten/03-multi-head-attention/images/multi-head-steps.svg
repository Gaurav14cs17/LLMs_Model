<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 750">
  <defs>
    <linearGradient id="inputGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="head1Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ee5a24;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="head2Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#a29bfe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#6c5ce7;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="head3Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#74b9ff;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0984e3;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="concatGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#55efc4;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00b894;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="outputGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fdcb6e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e17055;stop-opacity:1" />
    </linearGradient>
    <filter id="stepShadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="3" stdDeviation="2" flood-opacity="0.2"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="950" height="750" fill="#0d1117"/>
  
  <!-- Title -->
  <text x="475" y="30" text-anchor="middle" fill="#fff" font-family="Georgia, serif" font-size="22" font-weight="bold">Multi-Head Attention: Complete Step-by-Step</text>
  
  <!-- STEP 1 -->
  <rect x="30" y="55" width="100" height="25" rx="5" fill="#58a6ff"/>
  <text x="80" y="72" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">STEP 1</text>
  <text x="145" y="72" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="12">Input Embedding (d_model = 512)</text>
  
  <rect x="300" y="90" width="350" height="50" rx="8" fill="url(#inputGrad2)" filter="url(#stepShadow)"/>
  <text x="475" y="115" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Input X</text>
  <text x="475" y="132" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="11">Shape: (seq_len √ó 512)</text>
  
  <!-- Arrow down -->
  <path d="M 475 140 L 475 165" stroke="#667eea" stroke-width="2"/>
  <polygon points="475,175 470,165 480,165" fill="#667eea"/>
  
  <!-- STEP 2 -->
  <rect x="30" y="180" width="100" height="25" rx="5" fill="#58a6ff"/>
  <text x="80" y="197" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">STEP 2</text>
  <text x="145" y="197" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="12">Split into h heads with Linear Projections</text>
  
  <!-- Split visualization -->
  <rect x="200" y="215" width="550" height="100" rx="10" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  
  <text x="475" y="240" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">Each head gets its own Q, K, V through learned weight matrices (W_Q, W_K, W_V)</text>
  
  <!-- Three head projections -->
  <rect x="230" y="255" width="140" height="50" rx="6" fill="url(#head1Grad)" filter="url(#stepShadow)"/>
  <text x="300" y="277" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Head 1: Q‚ÇÅ, K‚ÇÅ, V‚ÇÅ</text>
  <text x="300" y="295" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="9">d_k = 64</text>
  
  <rect x="405" y="255" width="140" height="50" rx="6" fill="url(#head2Grad)" filter="url(#stepShadow)"/>
  <text x="475" y="277" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Head 2: Q‚ÇÇ, K‚ÇÇ, V‚ÇÇ</text>
  <text x="475" y="295" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="9">d_k = 64</text>
  
  <rect x="580" y="255" width="140" height="50" rx="6" fill="url(#head3Grad)" filter="url(#stepShadow)"/>
  <text x="650" y="277" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Head h: Q‚Çï, K‚Çï, V‚Çï</text>
  <text x="650" y="295" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="9">d_k = 64</text>
  
  <text x="545" y="280" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="16">...</text>
  
  <!-- Arrows down -->
  <path d="M 300 315 L 300 345" stroke="#ff6b6b" stroke-width="2"/>
  <path d="M 475 315 L 475 345" stroke="#a29bfe" stroke-width="2"/>
  <path d="M 650 315 L 650 345" stroke="#74b9ff" stroke-width="2"/>
  
  <!-- STEP 3 -->
  <rect x="30" y="330" width="100" height="25" rx="5" fill="#58a6ff"/>
  <text x="80" y="347" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">STEP 3</text>
  <text x="145" y="347" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="12">Parallel Attention Computation (each head independently)</text>
  
  <!-- Attention computation boxes -->
  <rect x="220" y="365" width="160" height="130" rx="8" fill="#161b22" stroke="#ff6b6b" stroke-width="2"/>
  <text x="300" y="390" text-anchor="middle" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Head 1 Attention</text>
  <text x="300" y="415" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">1. scores = Q‚ÇÅK‚ÇÅ·µÄ/‚àöd_k</text>
  <text x="300" y="435" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">2. weights = softmax(scores)</text>
  <text x="300" y="455" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">3. head‚ÇÅ = weights √ó V‚ÇÅ</text>
  <rect x="250" y="465" width="100" height="20" rx="4" fill="#ff6b6b" opacity="0.5"/>
  <text x="300" y="480" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Output: (n √ó 64)</text>
  
  <rect x="395" y="365" width="160" height="130" rx="8" fill="#161b22" stroke="#a29bfe" stroke-width="2"/>
  <text x="475" y="390" text-anchor="middle" fill="#a29bfe" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Head 2 Attention</text>
  <text x="475" y="415" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">1. scores = Q‚ÇÇK‚ÇÇ·µÄ/‚àöd_k</text>
  <text x="475" y="435" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">2. weights = softmax(scores)</text>
  <text x="475" y="455" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">3. head‚ÇÇ = weights √ó V‚ÇÇ</text>
  <rect x="425" y="465" width="100" height="20" rx="4" fill="#a29bfe" opacity="0.5"/>
  <text x="475" y="480" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Output: (n √ó 64)</text>
  
  <rect x="570" y="365" width="160" height="130" rx="8" fill="#161b22" stroke="#74b9ff" stroke-width="2"/>
  <text x="650" y="390" text-anchor="middle" fill="#74b9ff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Head h Attention</text>
  <text x="650" y="415" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">1. scores = Q‚ÇïK‚Çï·µÄ/‚àöd_k</text>
  <text x="650" y="435" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">2. weights = softmax(scores)</text>
  <text x="650" y="455" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">3. head‚Çï = weights √ó V‚Çï</text>
  <rect x="600" y="465" width="100" height="20" rx="4" fill="#74b9ff" opacity="0.5"/>
  <text x="650" y="480" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Output: (n √ó 64)</text>
  
  <!-- Parallel indicator -->
  <rect x="760" y="400" width="150" height="60" rx="8" fill="#21262d" stroke="#55efc4" stroke-width="1"/>
  <text x="835" y="425" text-anchor="middle" fill="#55efc4" font-family="Arial, sans-serif" font-size="11" font-weight="bold">‚ö° Parallel!</text>
  <text x="835" y="445" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="9">All heads computed</text>
  <text x="835" y="458" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="9">simultaneously</text>
  
  <!-- Arrows to concat -->
  <path d="M 300 495 L 300 530 L 400 555" stroke="#ff6b6b" stroke-width="2" fill="none"/>
  <path d="M 475 495 L 475 555" stroke="#a29bfe" stroke-width="2" fill="none"/>
  <path d="M 650 495 L 650 530 L 550 555" stroke="#74b9ff" stroke-width="2" fill="none"/>
  
  <!-- STEP 4 -->
  <rect x="30" y="530" width="100" height="25" rx="5" fill="#58a6ff"/>
  <text x="80" y="547" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">STEP 4</text>
  <text x="145" y="547" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="12">Concatenate All Head Outputs</text>
  
  <rect x="300" y="560" width="350" height="55" rx="8" fill="url(#concatGrad3)" filter="url(#stepShadow)"/>
  <text x="475" y="585" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Concat(head‚ÇÅ, head‚ÇÇ, ..., head‚Çï)</text>
  <text x="475" y="605" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="11">Shape: (seq_len √ó 512) ‚Äî restored to d_model!</text>
  
  <!-- Arrow to output -->
  <path d="M 475 615 L 475 645" stroke="#55efc4" stroke-width="2"/>
  <polygon points="475,655 470,645 480,645" fill="#55efc4"/>
  
  <!-- STEP 5 -->
  <rect x="30" y="650" width="100" height="25" rx="5" fill="#58a6ff"/>
  <text x="80" y="667" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">STEP 5</text>
  <text x="145" y="667" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="12">Final Linear Projection (W_O)</text>
  
  <rect x="300" y="685" width="350" height="50" rx="8" fill="url(#outputGrad2)" filter="url(#stepShadow)"/>
  <text x="475" y="710" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Output = Concat √ó W_O</text>
  <text x="475" y="727" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="11">Final Shape: (seq_len √ó 512)</text>
  
  <!-- Side note -->
  <rect x="700" y="560" width="220" height="110" rx="8" fill="#21262d" stroke="#fdcb6e" stroke-width="1"/>
  <text x="810" y="585" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="11" font-weight="bold">üí° Key Insight</text>
  <text x="810" y="610" text-anchor="middle" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="10">h heads √ó d_k = d_model</text>
  <text x="810" y="630" text-anchor="middle" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="10">8 heads √ó 64 = 512</text>
  <text x="810" y="655" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="9">Same total computation</text>
  <text x="810" y="668" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="9">as single-head!</text>
</svg>

