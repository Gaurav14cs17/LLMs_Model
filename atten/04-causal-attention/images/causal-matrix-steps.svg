<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 700">
  <defs>
    <linearGradient id="allowGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#55efc4;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00b894;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="blockGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e17055;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#d63031;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow3" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="700" fill="#0d1117"/>
  
  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" fill="#fff" font-family="Georgia, serif" font-size="22" font-weight="bold">Causal Attention: NÃ—N Matrix Step-by-Step</text>
  <text x="450" y="58" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="12">"The cat sat on" (4 tokens)</text>
  
  <!-- STEP 1: Raw Scores -->
  <rect x="30" y="80" width="120" height="30" rx="5" fill="#21262d"/>
  <text x="90" y="100" text-anchor="middle" fill="#58a6ff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">STEP 1</text>
  <text x="165" y="100" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="13">Raw Attention Scores (QK^T) â€” Full 4Ã—4 Matrix</text>
  
  <!-- Full 4x4 Matrix -->
  <rect x="100" y="120" width="280" height="180" rx="10" fill="#161b22" stroke="#58a6ff" stroke-width="2"/>
  
  <!-- Column headers -->
  <text x="240" y="143" text-anchor="middle" fill="#4facfe" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Keys â†’</text>
  <text x="175" y="160" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">The</text>
  <text x="225" y="160" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">cat</text>
  <text x="275" y="160" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">sat</text>
  <text x="325" y="160" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">on</text>
  
  <!-- Row headers -->
  <text x="135" y="190" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">The</text>
  <text x="135" y="220" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">cat</text>
  <text x="135" y="250" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">sat</text>
  <text x="135" y="280" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">on</text>
  
  <!-- Score values - Row 1 -->
  <rect x="155" y="175" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.8"/>
  <text x="175" y="191" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.8</text>
  <rect x="205" y="175" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="225" y="191" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.4</text>
  <rect x="255" y="175" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="275" y="191" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.3</text>
  <rect x="305" y="175" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.3"/>
  <text x="325" y="191" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.2</text>
  
  <!-- Score values - Row 2 -->
  <rect x="155" y="205" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.6"/>
  <text x="175" y="221" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.5</text>
  <rect x="205" y="205" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.9"/>
  <text x="225" y="221" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.9</text>
  <rect x="255" y="205" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.7"/>
  <text x="275" y="221" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.6</text>
  <rect x="305" y="205" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="325" y="221" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.4</text>
  
  <!-- Score values - Row 3 -->
  <rect x="155" y="235" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="175" y="251" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.3</text>
  <rect x="205" y="235" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.8"/>
  <text x="225" y="251" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.7</text>
  <rect x="255" y="235" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.9"/>
  <text x="275" y="251" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.8</text>
  <rect x="305" y="235" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.6"/>
  <text x="325" y="251" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.5</text>
  
  <!-- Score values - Row 4 -->
  <rect x="155" y="265" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="175" y="281" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.4</text>
  <rect x="205" y="265" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.6"/>
  <text x="225" y="281" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.5</text>
  <rect x="255" y="265" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.7"/>
  <text x="275" y="281" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.6</text>
  <rect x="305" y="265" width="40" height="22" rx="3" fill="#58a6ff" opacity="0.8"/>
  <text x="325" y="281" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.7</text>
  
  <!-- Arrow -->
  <path d="M 395 200 L 430 200" stroke="#58a6ff" stroke-width="3"/>
  <polygon points="440,200 430,195 430,205" fill="#58a6ff"/>
  
  <!-- STEP 2: Apply Mask -->
  <rect x="450" y="80" width="120" height="30" rx="5" fill="#21262d"/>
  <text x="510" y="100" text-anchor="middle" fill="#58a6ff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">STEP 2</text>
  <text x="585" y="100" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="13">Apply Causal Mask (Add -âˆž)</text>
  
  <!-- Masked 4x4 Matrix -->
  <rect x="470" y="120" width="280" height="180" rx="10" fill="#161b22" stroke="#e17055" stroke-width="2"/>
  
  <!-- Column headers -->
  <text x="610" y="143" text-anchor="middle" fill="#e17055" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Future â†’ -âˆž</text>
  <text x="545" y="160" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">The</text>
  <text x="595" y="160" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">cat</text>
  <text x="645" y="160" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">sat</text>
  <text x="695" y="160" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">on</text>
  
  <!-- Row headers -->
  <text x="505" y="190" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">The</text>
  <text x="505" y="220" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">cat</text>
  <text x="505" y="250" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">sat</text>
  <text x="505" y="280" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">on</text>
  
  <!-- Row 1 - Only self allowed -->
  <rect x="525" y="175" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="545" y="191" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.8</text>
  <rect x="575" y="175" width="40" height="22" rx="3" fill="url(#blockGrad2)" opacity="0.4"/>
  <text x="595" y="191" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">-âˆž</text>
  <rect x="625" y="175" width="40" height="22" rx="3" fill="url(#blockGrad2)" opacity="0.4"/>
  <text x="645" y="191" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">-âˆž</text>
  <rect x="675" y="175" width="40" height="22" rx="3" fill="url(#blockGrad2)" opacity="0.4"/>
  <text x="695" y="191" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">-âˆž</text>
  
  <!-- Row 2 -->
  <rect x="525" y="205" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="545" y="221" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.5</text>
  <rect x="575" y="205" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="595" y="221" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.9</text>
  <rect x="625" y="205" width="40" height="22" rx="3" fill="url(#blockGrad2)" opacity="0.4"/>
  <text x="645" y="221" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">-âˆž</text>
  <rect x="675" y="205" width="40" height="22" rx="3" fill="url(#blockGrad2)" opacity="0.4"/>
  <text x="695" y="221" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">-âˆž</text>
  
  <!-- Row 3 -->
  <rect x="525" y="235" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="545" y="251" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.3</text>
  <rect x="575" y="235" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="595" y="251" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.7</text>
  <rect x="625" y="235" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="645" y="251" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.8</text>
  <rect x="675" y="235" width="40" height="22" rx="3" fill="url(#blockGrad2)" opacity="0.4"/>
  <text x="695" y="251" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">-âˆž</text>
  
  <!-- Row 4 - All allowed -->
  <rect x="525" y="265" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="545" y="281" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.4</text>
  <rect x="575" y="265" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="595" y="281" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.5</text>
  <rect x="625" y="265" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="645" y="281" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.6</text>
  <rect x="675" y="265" width="40" height="22" rx="3" fill="url(#allowGrad2)"/>
  <text x="695" y="281" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">0.7</text>
  
  <!-- Legend -->
  <rect x="770" y="180" width="110" height="70" rx="6" fill="#21262d"/>
  <rect x="780" y="195" width="15" height="12" rx="2" fill="url(#allowGrad2)"/>
  <text x="800" y="205" fill="#8b949e" font-family="Arial, sans-serif" font-size="9">Past/Self</text>
  <rect x="780" y="215" width="15" height="12" rx="2" fill="url(#blockGrad2)" opacity="0.4"/>
  <text x="800" y="225" fill="#8b949e" font-family="Arial, sans-serif" font-size="9">Future (-âˆž)</text>
  <text x="780" y="243" fill="#55efc4" font-family="Arial, sans-serif" font-size="8">Lower triangular!</text>
  
  <!-- Arrow down -->
  <path d="M 450 320 L 450 360" stroke="#e17055" stroke-width="3"/>
  <polygon points="450,370 445,360 455,360" fill="#e17055"/>
  
  <!-- STEP 3: After Softmax -->
  <rect x="30" y="380" width="120" height="30" rx="5" fill="#21262d"/>
  <text x="90" y="400" text-anchor="middle" fill="#58a6ff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">STEP 3</text>
  <text x="165" y="400" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="13">After Softmax: -âˆž becomes 0, rows sum to 1</text>
  
  <!-- Final Matrix -->
  <rect x="200" y="420" width="500" height="210" rx="10" fill="#161b22" stroke="#55efc4" stroke-width="2"/>
  
  <!-- Column headers -->
  <text x="450" y="445" text-anchor="middle" fill="#55efc4" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Final Attention Weights (After Softmax)</text>
  <text x="310" y="465" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">The</text>
  <text x="390" y="465" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">cat</text>
  <text x="470" y="465" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">sat</text>
  <text x="550" y="465" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">on</text>
  <text x="630" y="465" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Sum</text>
  
  <!-- Row headers -->
  <text x="245" y="495" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">The</text>
  <text x="245" y="530" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">cat</text>
  <text x="245" y="565" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">sat</text>
  <text x="245" y="600" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="11">on</text>
  
  <!-- Row 1 -->
  <rect x="280" y="480" width="60" height="25" rx="4" fill="#55efc4"/>
  <text x="310" y="498" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="12" font-weight="bold">1.00</text>
  <rect x="360" y="480" width="60" height="25" rx="4" fill="#8b949e" opacity="0.3"/>
  <text x="390" y="498" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="12">0.00</text>
  <rect x="440" y="480" width="60" height="25" rx="4" fill="#8b949e" opacity="0.3"/>
  <text x="470" y="498" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="12">0.00</text>
  <rect x="520" y="480" width="60" height="25" rx="4" fill="#8b949e" opacity="0.3"/>
  <text x="550" y="498" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="12">0.00</text>
  <text x="630" y="498" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="11">âœ“ 1.0</text>
  
  <!-- Row 2 -->
  <rect x="280" y="515" width="60" height="25" rx="4" fill="#55efc4" opacity="0.5"/>
  <text x="310" y="533" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">0.40</text>
  <rect x="360" y="515" width="60" height="25" rx="4" fill="#55efc4"/>
  <text x="390" y="533" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="12" font-weight="bold">0.60</text>
  <rect x="440" y="515" width="60" height="25" rx="4" fill="#8b949e" opacity="0.3"/>
  <text x="470" y="533" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="12">0.00</text>
  <rect x="520" y="515" width="60" height="25" rx="4" fill="#8b949e" opacity="0.3"/>
  <text x="550" y="533" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="12">0.00</text>
  <text x="630" y="533" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="11">âœ“ 1.0</text>
  
  <!-- Row 3 -->
  <rect x="280" y="550" width="60" height="25" rx="4" fill="#55efc4" opacity="0.3"/>
  <text x="310" y="568" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">0.22</text>
  <rect x="360" y="550" width="60" height="25" rx="4" fill="#55efc4" opacity="0.5"/>
  <text x="390" y="568" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">0.35</text>
  <rect x="440" y="550" width="60" height="25" rx="4" fill="#55efc4"/>
  <text x="470" y="568" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="12" font-weight="bold">0.43</text>
  <rect x="520" y="550" width="60" height="25" rx="4" fill="#8b949e" opacity="0.3"/>
  <text x="550" y="568" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="12">0.00</text>
  <text x="630" y="568" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="11">âœ“ 1.0</text>
  
  <!-- Row 4 -->
  <rect x="280" y="585" width="60" height="25" rx="4" fill="#55efc4" opacity="0.25"/>
  <text x="310" y="603" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">0.18</text>
  <rect x="360" y="585" width="60" height="25" rx="4" fill="#55efc4" opacity="0.35"/>
  <text x="390" y="603" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">0.22</text>
  <rect x="440" y="585" width="60" height="25" rx="4" fill="#55efc4" opacity="0.4"/>
  <text x="470" y="603" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12">0.26</text>
  <rect x="520" y="585" width="60" height="25" rx="4" fill="#55efc4"/>
  <text x="550" y="603" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="12" font-weight="bold">0.34</text>
  <text x="630" y="603" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="11">âœ“ 1.0</text>
  
  <!-- Key insight -->
  <rect x="100" y="645" width="700" height="40" rx="8" fill="#21262d" stroke="#fdcb6e" stroke-width="1"/>
  <text x="450" y="670" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="12" font-weight="bold">ðŸ’¡ Each row only has non-zero weights for PAST positions â†’ No future information leakage!</text>
</svg>

