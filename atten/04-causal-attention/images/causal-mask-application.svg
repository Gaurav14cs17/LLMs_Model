<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500">
  <defs>
    <linearGradient id="visibleGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#58a6ff;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1f6feb;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="maskedGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e84393;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#fd79a8;stop-opacity:1" />
    </linearGradient>
    <pattern id="crossHatch" patternUnits="userSpaceOnUse" width="8" height="8">
      <path d="M-2,2 l4,-4 M0,8 l8,-8 M6,10 l4,-4" stroke="#e84393" stroke-width="1.5" opacity="0.6"/>
    </pattern>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="500" fill="#0d1117"/>
  
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" fill="#fff" font-family="Georgia, serif" font-size="18" font-weight="bold">Causal Mask: Step-by-Step Application</text>
  
  <!-- Step 1: Raw Scores -->
  <rect x="30" y="55" width="120" height="25" rx="5" fill="#21262d"/>
  <text x="90" y="72" text-anchor="middle" fill="#58a6ff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">STEP 1</text>
  <text x="165" y="72" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="12">Compute raw attention scores (QK^T)</text>
  
  <rect x="50" y="90" width="230" height="180" rx="10" fill="#161b22" stroke="#58a6ff" stroke-width="2"/>
  
  <!-- Headers -->
  <text x="120" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₁</text>
  <text x="160" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₂</text>
  <text x="200" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₃</text>
  <text x="240" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₄</text>
  
  <text x="80" y="145" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₁</text>
  <text x="80" y="180" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₂</text>
  <text x="80" y="215" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₃</text>
  <text x="80" y="250" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₄</text>
  
  <!-- All cells with scores -->
  <rect x="100" y="125" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="117" y="145" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.8</text>
  <rect x="140" y="125" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="157" y="145" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.3</text>
  <rect x="180" y="125" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.3"/>
  <text x="197" y="145" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.2</text>
  <rect x="220" y="125" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.2"/>
  <text x="237" y="145" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.1</text>
  
  <rect x="100" y="160" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="117" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.5</text>
  <rect x="140" y="160" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.7"/>
  <text x="157" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.9</text>
  <rect x="180" y="160" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="197" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.4</text>
  <rect x="220" y="160" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.3"/>
  <text x="237" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.2</text>
  
  <rect x="100" y="195" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.3"/>
  <text x="117" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.3</text>
  <rect x="140" y="195" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="157" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.7</text>
  <rect x="180" y="195" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.6"/>
  <text x="197" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.8</text>
  <rect x="220" y="195" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="237" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.5</text>
  
  <rect x="100" y="230" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.3"/>
  <text x="117" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.4</text>
  <rect x="140" y="230" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="157" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.5</text>
  <rect x="180" y="230" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="197" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.6</text>
  <rect x="220" y="230" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.6"/>
  <text x="237" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.7</text>
  
  <!-- Arrow -->
  <text x="310" y="180" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="24">→</text>
  <text x="310" y="205" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">+ Mask</text>
  
  <!-- Step 2: Add Mask -->
  <rect x="330" y="55" width="120" height="25" rx="5" fill="#21262d"/>
  <text x="390" y="72" text-anchor="middle" fill="#e84393" font-family="Arial, sans-serif" font-size="12" font-weight="bold">STEP 2</text>
  <text x="465" y="72" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="12">Add -∞ to future positions</text>
  
  <rect x="350" y="90" width="230" height="180" rx="10" fill="#161b22" stroke="#e84393" stroke-width="2"/>
  
  <!-- Headers -->
  <text x="420" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₁</text>
  <text x="460" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₂</text>
  <text x="500" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₃</text>
  <text x="540" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₄</text>
  
  <text x="380" y="145" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₁</text>
  <text x="380" y="180" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₂</text>
  <text x="380" y="215" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₃</text>
  <text x="380" y="250" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₄</text>
  
  <!-- Row 1: Only t1 visible -->
  <rect x="400" y="125" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="417" y="145" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.8</text>
  <rect x="440" y="125" width="35" height="30" rx="3" fill="url(#crossHatch)"/>
  <text x="457" y="145" text-anchor="middle" fill="#e84393" font-family="Arial, sans-serif" font-size="9">-∞</text>
  <rect x="480" y="125" width="35" height="30" rx="3" fill="url(#crossHatch)"/>
  <text x="497" y="145" text-anchor="middle" fill="#e84393" font-family="Arial, sans-serif" font-size="9">-∞</text>
  <rect x="520" y="125" width="35" height="30" rx="3" fill="url(#crossHatch)"/>
  <text x="537" y="145" text-anchor="middle" fill="#e84393" font-family="Arial, sans-serif" font-size="9">-∞</text>
  
  <!-- Row 2: t1, t2 visible -->
  <rect x="400" y="160" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="417" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.5</text>
  <rect x="440" y="160" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.7"/>
  <text x="457" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.9</text>
  <rect x="480" y="160" width="35" height="30" rx="3" fill="url(#crossHatch)"/>
  <text x="497" y="180" text-anchor="middle" fill="#e84393" font-family="Arial, sans-serif" font-size="9">-∞</text>
  <rect x="520" y="160" width="35" height="30" rx="3" fill="url(#crossHatch)"/>
  <text x="537" y="180" text-anchor="middle" fill="#e84393" font-family="Arial, sans-serif" font-size="9">-∞</text>
  
  <!-- Row 3: t1, t2, t3 visible -->
  <rect x="400" y="195" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.3"/>
  <text x="417" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.3</text>
  <rect x="440" y="195" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="457" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.7</text>
  <rect x="480" y="195" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.6"/>
  <text x="497" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.8</text>
  <rect x="520" y="195" width="35" height="30" rx="3" fill="url(#crossHatch)"/>
  <text x="537" y="215" text-anchor="middle" fill="#e84393" font-family="Arial, sans-serif" font-size="9">-∞</text>
  
  <!-- Row 4: All visible -->
  <rect x="400" y="230" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.3"/>
  <text x="417" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.4</text>
  <rect x="440" y="230" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.4"/>
  <text x="457" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.5</text>
  <rect x="480" y="230" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.5"/>
  <text x="497" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.6</text>
  <rect x="520" y="230" width="35" height="30" rx="3" fill="#58a6ff" opacity="0.6"/>
  <text x="537" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">0.7</text>
  
  <!-- Arrow -->
  <text x="610" y="180" text-anchor="middle" fill="#fdcb6e" font-family="Arial, sans-serif" font-size="24">→</text>
  <text x="610" y="205" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">softmax</text>
  
  <!-- Step 3: After Softmax -->
  <rect x="630" y="55" width="120" height="25" rx="5" fill="#21262d"/>
  <text x="690" y="72" text-anchor="middle" fill="#55efc4" font-family="Arial, sans-serif" font-size="12" font-weight="bold">STEP 3</text>
  <text x="765" y="72" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="12">Softmax → weights</text>
  
  <rect x="650" y="90" width="230" height="180" rx="10" fill="#161b22" stroke="#55efc4" stroke-width="2"/>
  
  <!-- Headers -->
  <text x="720" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₁</text>
  <text x="760" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₂</text>
  <text x="800" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₃</text>
  <text x="840" y="115" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₄</text>
  
  <text x="680" y="145" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₁</text>
  <text x="680" y="180" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₂</text>
  <text x="680" y="215" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₃</text>
  <text x="680" y="250" text-anchor="middle" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">t₄</text>
  
  <!-- Row 1 -->
  <rect x="700" y="125" width="35" height="30" rx="3" fill="#55efc4" opacity="0.9"/>
  <text x="717" y="145" text-anchor="middle" fill="#0d1117" font-family="Arial, sans-serif" font-size="9" font-weight="bold">1.0</text>
  <rect x="740" y="125" width="35" height="30" rx="3" fill="#21262d"/>
  <text x="757" y="145" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="9">0</text>
  <rect x="780" y="125" width="35" height="30" rx="3" fill="#21262d"/>
  <text x="797" y="145" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="9">0</text>
  <rect x="820" y="125" width="35" height="30" rx="3" fill="#21262d"/>
  <text x="837" y="145" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="9">0</text>
  
  <!-- Row 2 -->
  <rect x="700" y="160" width="35" height="30" rx="3" fill="#55efc4" opacity="0.35"/>
  <text x="717" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.36</text>
  <rect x="740" y="160" width="35" height="30" rx="3" fill="#55efc4" opacity="0.64"/>
  <text x="757" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.64</text>
  <rect x="780" y="160" width="35" height="30" rx="3" fill="#21262d"/>
  <text x="797" y="180" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="9">0</text>
  <rect x="820" y="160" width="35" height="30" rx="3" fill="#21262d"/>
  <text x="837" y="180" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="9">0</text>
  
  <!-- Row 3 -->
  <rect x="700" y="195" width="35" height="30" rx="3" fill="#55efc4" opacity="0.18"/>
  <text x="717" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.18</text>
  <rect x="740" y="195" width="35" height="30" rx="3" fill="#55efc4" opacity="0.33"/>
  <text x="757" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.33</text>
  <rect x="780" y="195" width="35" height="30" rx="3" fill="#55efc4" opacity="0.49"/>
  <text x="797" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.49</text>
  <rect x="820" y="195" width="35" height="30" rx="3" fill="#21262d"/>
  <text x="837" y="215" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="9">0</text>
  
  <!-- Row 4 -->
  <rect x="700" y="230" width="35" height="30" rx="3" fill="#55efc4" opacity="0.14"/>
  <text x="717" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.14</text>
  <rect x="740" y="230" width="35" height="30" rx="3" fill="#55efc4" opacity="0.19"/>
  <text x="757" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.19</text>
  <rect x="780" y="230" width="35" height="30" rx="3" fill="#55efc4" opacity="0.26"/>
  <text x="797" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.26</text>
  <rect x="820" y="230" width="35" height="30" rx="3" fill="#55efc4" opacity="0.41"/>
  <text x="837" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">.41</text>
  
  <!-- Explanations -->
  <rect x="50" y="290" width="250" height="190" rx="10" fill="#21262d" stroke="#58a6ff" stroke-width="1"/>
  <text x="175" y="315" text-anchor="middle" fill="#58a6ff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">What Each Row Can See</text>
  <text x="70" y="345" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• t₁ sees: [t₁]</text>
  <text x="70" y="370" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• t₂ sees: [t₁, t₂]</text>
  <text x="70" y="395" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• t₃ sees: [t₁, t₂, t₃]</text>
  <text x="70" y="420" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• t₄ sees: [t₁, t₂, t₃, t₄]</text>
  <text x="70" y="460" fill="#8b949e" font-family="Arial, sans-serif" font-size="10">Each position only sees past + itself!</text>
  
  <rect x="330" y="290" width="250" height="190" rx="10" fill="#21262d" stroke="#e84393" stroke-width="1"/>
  <text x="455" y="315" text-anchor="middle" fill="#e84393" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Why -∞ Works</text>
  <text x="350" y="345" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• softmax(-∞) = 0</text>
  <text x="350" y="375" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• Future tokens get zero</text>
  <text x="350" y="395" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">  attention weight</text>
  <text x="350" y="430" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• Model cannot "cheat"</text>
  <text x="350" y="450" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">  by looking ahead</text>
  
  <rect x="610" y="290" width="270" height="190" rx="10" fill="#21262d" stroke="#55efc4" stroke-width="1"/>
  <text x="745" y="315" text-anchor="middle" fill="#55efc4" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Result: Lower Triangular</text>
  <text x="630" y="345" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• Upper triangle = 0</text>
  <text x="630" y="370" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• Lower triangle = valid weights</text>
  <text x="630" y="395" fill="#c9d1d9" font-family="Arial, sans-serif" font-size="11">• Each row sums to 1.0</text>
  <text x="630" y="430" fill="#55efc4" font-family="Arial, sans-serif" font-size="11">Essential for autoregressive</text>
  <text x="630" y="450" fill="#55efc4" font-family="Arial, sans-serif" font-size="11">language generation!</text>
</svg>

